<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Test</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas" width="960" height="640"></canvas>

<script>
	var canvas = document.getElementById("myCanvas");
	var ctx = canvas.getContext("2d");
	var x = canvas.width/2;
	var y = canvas.height-41;
	var dx = 1;
	var dy = -1;
	var barraHeight = 10;
	var barraWidth = 75;
	var barraX = (canvas.width-barraWidth)/2;
	var rightPressed = false;
	var leftPressed = false;
	var brick_x_ref = 85;
	var brick_y_ref = 30;
	var brick_x_dist = 20;
	var brick_y_dist = 15;
	
	var brick_array = [[1, 1, 1, 1, 1,1,1,1,1,1],[1, 1, 1, 1, 1,1,1,1,1,1],[1, 1, 1, 1, 1,1,1,1,1,1],[1, 1, 1, 1, 1,1,1,1,1,1]];
		
	function drawBrick(){
		
		for(i=0;i<4;i++){
			for(j=0;j<10;j++){
				if(brick_array[i][j]===1){
					ctx.beginPath();
					ctx.rect(brick_x_ref + j*(60+brick_x_dist),brick_y_ref+ i*(30+brick_y_dist),60,30);
					ctx.fillStyle = "#0095DD";
					ctx.fill();
					ctx.closePath();
				}
			}
		}
	}
	function drawBall(){		
		ctx.beginPath();
		ctx.arc(x, y, 10, 0, Math.PI*2);
		ctx.fillStyle = "#f92626";
		ctx.fill();
		ctx.closePath();
	}
	function drawBarra(){
		if(rightPressed && barraX+barraWidth<canvas.width){
			barraX+=2;
		}
		if(leftPressed && barraX>0){
			barraX-=2;
		}
		ctx.beginPath();
		ctx.rect(barraX,canvas.height-30,barraWidth,barraHeight);
		ctx.fillStyle = "#f5da0c";
		ctx.fill();
		ctx.closePath();
	}
	function draw(){
		ctx.clearRect(0,0,canvas.width, canvas.height);
		drawBall();
		drawBarra();
		drawBrick();
		collisionDetection();
		if(x+10 === canvas.width || x-10 === 0){
			dx=dx*-1;
		}		
		if(y-10 === 0){
			dy=dy*-1;
		}
		if(y+10===canvas.height-30 && (x>=barraX-10 && x<=barraX+barraWidth+10)){
			dy=dy*-1;
		}
		if(y+5 === canvas.height){
			    alert("GAME OVER");
				document.location.reload();
		}
		x += dx;
		y += dy;
	}
	function keyDownHandler(e) {
		if(e.keyCode == 39) {
			rightPressed = true;
		}
		else if(e.keyCode == 37) {
			leftPressed = true;
		}
	}
	function keyUpHandler(e) {
		if(e.keyCode == 39) {
			rightPressed = false;
		}
		else if(e.keyCode == 37) {
			leftPressed = false;
		}
	}
	function collisionDetection() {
		for(c=0; c<4; c++) {
			for(r=0; r<10; r++) {
				if(brick_array[c][r]===1){
					if(x > (brick_x_ref + r*(60+brick_x_dist)) && x < (brick_x_ref + r*(60+brick_x_dist)+60) && y>(brick_y_ref+ c*(30+brick_y_dist)) && y< (brick_y_ref+ c*(30+brick_y_dist)+30)){
						//if(dx>0) dx++;
						//if(dx<0) dx--;
						//if(dy>0) dy++;
						//if(dy<0) dy--;
						dx = dx*-1;
						dy = dy*-1;
						brick_array[c][r]=0;
					}
				}				
			}
		}
	}
	document.addEventListener("keydown", keyDownHandler, false);
	document.addEventListener("keyup", keyUpHandler, false);
	setInterval(draw,5);

</script>

</body>
</html>